<%# Condition Template %>
<%# Based on https://mcodeinitiative.github.io/StructureDefinition-obf-Condition.html %>
<%# Official url: http://hl7.org/fhir/us/mcode/StructureDefinition/obf-Condition %>
<% /* %>
{
  id: String,
  subject: {
    id: String,
    name: String,
  },
  code: [{
    system: String,
    code: String,
    display: String,
  }],
}
<% */ %>
{
  "resourceType": "Condition",
  "id": "<%- id %>",
  "subject" : {
    "reference": "urn:uuid:<%- subject.id %>"<% if (subject.name) { %>,
    "display": "<%- subject.name %>"
    <% } %>
  },
  "code": {
    "coding": [ <% codes.forEach((c, i) => {%>
      {
        "system": "<%- c.system %>",
        "code": "<%- c.code %>"<% if (c.display) { %>,
        "display": "<%- c.display %>"
        <% } %>
      }<% if (i + 1 < codes.length) { %>,<% }%>
    <%})%>
    ]
  },
  "category": [
    {
      "coding": [
        {
          "system": "http://terminology.hl7.org/CodeSystem/condition-category",
          "code": "problem-list-item"
        }
      ]
    }
  ],
  "verificationStatus": {
    "coding": [
      {
        "system": "http://terminology.hl7.org/CodeSystem/condition-ver-status",
        "code": "confirmed"
      }
    ]
  }
}
